<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Python for Official Statistics: Data Transformation</title><meta name="viewport" content="width=device-width, initial-scale=1"><script src="../assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="../assets/styles.css"><script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../favicons/cp/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicons/cp/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="../favicons/cp/favicon-16x16.png"><link rel="manifest" href="../favicons/cp/site.webmanifest"><link rel="mask-icon" href="../favicons/cp/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="black"></head><body>
    <header id="top" class="navbar navbar-expand-md top-nav carpentries"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="cp-logo" alt="The Carpentries" src="../assets/images/carpentries-logo.svg"><span class="badge text-bg-danger">
          <abbr title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.">
            <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#early-development-pre-alpha-through-alpha" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
              Pre-Alpha
            </a>
            <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text"><li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul></li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='../04-data_transformation.html';">Learner View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav carpentries" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="The Carpentries" src="../assets/images/carpentries-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Python for Official Statistics
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Python for Official Statistics
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><hr><li><a class="dropdown-item" href="discuss.html">Discussion</a></li><li><a class="dropdown-item" href="reference.html">Glossary</a></li>
          </ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="../instructor/aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Python for Official Statistics
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 16%" class="percentage">
    16%
  </div>
  <div class="progress carpentries">
    <div class="progress-bar carpentries" role="progressbar" style="width: 16%" aria-valuenow="16" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text"><li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul></li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../04-data_transformation.html">Learner View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->

            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="01-introduction.html">1. Introduction</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="02-python_fundamentals.html">2. Python Fundamentals</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="03-lists_dictionaries.html">3. List and Dictionary Methods</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        4. Data Transformation
        </span>
      </button>
    </div><!--/div.accordion-header-->

    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#introduction">Introduction</a></li>
<li><a href="#loading-data">Loading data</a></li>
<li><a href="#data-exploration">Data exploration</a></li>
<li><a href="#cleaning-data">Cleaning data</a></li>
<li><a href="#transforming-data">Transforming data</a></li>
<li><a href="#merging-and-joining-data">Merging and joining data</a></li>
<li><a href="#aggregating-data">Aggregating data</a></li>
<li><a href="#exporting-data">Exporting data</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="05-data_visualisation.html">5. Visualizations</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="06-loops.html">6. Loops and Conditional Logic</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="07-apis.html">7. Fetching data from APIs</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="08-functions.html">8. Creating Functions</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush10">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading10">
        <a href="09-errors_exceptions.html">9. Errors and Exceptions</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <hr><li><a class="dropdown-item" href="discuss.html">Discussion</a></li><li><a class="dropdown-item" href="reference.html">Glossary</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources"><a href="../instructor/aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">

            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/03-lists_dictionaries.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/05-data_visualisation.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/03-lists_dictionaries.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: List and Dictionary
        </a>
        <a class="chapter-link float-end" href="../instructor/05-data_visualisation.html" rel="next">
          Next: Visualizations...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Data Transformation</h1>
        <p>Last updated on 2024-12-11 |

        <a href="https://github.com/UNECE/ModernStats_Python/edit/main/episodes/04-data_transformation.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>



        <p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 120 minutes</p>

        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>How can I process tabular data files in Python?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Explain what a library is and what libraries are used for.</li>
<li>Import a Python library and use the functions it contains.</li>
<li>Read tabular data from a file into a program.</li>
<li>Clean and prepare data.</li>
<li>Merge and reshape data.</li>
<li>Handle missing values.</li>
<li>Aggregate and summarize data.</li>
</ul></div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a></h2>
<hr class="half-width"><div class="section level3">
<h3 id="what-is-a-packagelibrary-in-python">What is a Package/Library in Python?<a class="anchor" aria-label="anchor" href="#what-is-a-packagelibrary-in-python"></a></h3>
<p>In Python, a <a href="../(../learners/reference.html#library)">library</a> (or package) is
a collection of pre-written code that you can use to perform common
tasks without needing to write the code from scratch. It’s a toolbox
that provides tools (functions, classes, and modules) to help you solve
specific problems.</p>
<p>Python packages save time and effort by providing solutions to common
programming challenges. Instead of reinventing the wheel, you can
<code>import</code> these tools into your scripts and use them to
complete tasks more easily.</p>
</div>
<div class="section level3">
<h3 id="a-python-package-for-data-manipulations-pandas">A Python package for data manipulations: <code>pandas</code>
<a class="anchor" aria-label="anchor" href="#a-python-package-for-data-manipulations-pandas"></a></h3>
<p>In this lesson, we will focus on using the
<strong><code>pandas</code></strong> library in Python to perform common
data wrangling tasks.</p>
<p><code>pandas</code> is an open-source Python library for data
manipulation and analysis. It provides data structures like
<strong><code>DataFrame</code></strong> and
<strong><code>Series</code></strong> that make it easy to handle and
analyze data.</p>
<div class="section level4">
<h4 id="series"><code>Series</code><a class="anchor" aria-label="anchor" href="#series"></a></h4>
<p>A <code>Series</code> is a one-dimensional labeled array, similar to
a list. It can hold any data type, such as integers, strings, or even
more complex data types.</p>
<p>Key Features:</p>
<ul><li>It’s one-dimensional, so it holds data in a single column.</li>
<li>It has an index (labels) that you can use to access specific
elements.</li>
<li>Each element in the Series has a label (index) and a value.</li>
</ul><p>Example of a <code>Series</code>:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co"># Create a Series from a list</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>data <span class="op">=</span> [<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>]</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>series <span class="op">=</span> pd.Series(data)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="co"># Print the Series</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="bu">print</span>(series)</span></code></pre>
</div>
<p>Output:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>0 10
1 20
2 30
3 40
4 50
dtype: int64</code></pre>
</div>
<p>The index is 0, 1, 2, 3, 4, and the values are 10, 20, 30, 40, 50.
<code>pandas</code> automatically creates an index for you (starting
from 0), but you can also specify a custom index.</p>
</div>
<div class="section level4">
<h4 id="dataframe"><code>DataFrame</code><a class="anchor" aria-label="anchor" href="#dataframe"></a></h4>
<p>A <code>DataFrame</code> is a two-dimensional, table-like structure
(similar to a spreadsheet or SQL table) that can hold multiple
<code>Series</code>. It is the most commonly used <code>pandas</code>
object.</p>
<p>A <code>DataFrame</code> consists of:</p>
<ul><li>Rows (with an index, just like a <code>Series</code>),</li>
<li>Columns (which are each <code>Series</code>).</li>
</ul><p>You can think of a <code>DataFrame</code> as a collection of
<code>Series</code> that share the same index.</p>
<p>Key Features:</p>
<ul><li>It’s two-dimensional.</li>
<li>Each column is a <code>Series</code>.</li>
<li>It has both row and column labels (indexes and column names).</li>
<li>It can hold multiple data types (integers, strings, floats,
etc.).</li>
</ul><p>Example of a <code>DataFrame</code>:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co"># Create a DataFrame using a dictionary</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>data <span class="op">=</span> {</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="st">'Name'</span>: [<span class="st">'Alice'</span>, <span class="st">'Bob'</span>, <span class="st">'Charlie'</span>],</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="st">'Age'</span>: [<span class="dv">25</span>, <span class="dv">30</span>, <span class="dv">35</span>],</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="st">'City'</span>: [<span class="st">'New York'</span>, <span class="st">'Paris'</span>, <span class="st">'Seoul'</span>]</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>}</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="co"># Print the DataFrame</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="bu">print</span>(df)</span></code></pre>
</div>
<p>Output:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Name Age City
0 Alice 25 New York
1 Bob 30 Los Angeles
2 Charlie 35 Chicago</code></pre>
</div>
<ul><li>The <strong>rows</strong> are indexed from 0, 1, 2 (default
index).</li>
<li>The <strong>columns</strong> are <code>Name</code>,
<code>Age</code>, and <code>City</code>.</li>
<li>Each column is a <strong>Series</strong>, so the <code>Name</code>
column is a <code>Series</code>, the <code>Age</code> column is another
<code>Series</code>, etc.</li>
</ul><div id="import-methods" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="import-methods" class="callout-inner">
<h3 class="callout-title">Import methods</h3>
<div class="callout-content">
<p>In Python, libraries (or modules) can be imported into your code
using the <code>import</code> statement. This allows you to access the
functions, classes, and methods defined in that library. There are
several ways to do it:</p>
<ol style="list-style-type: decimal"><li>Full import: <code>import pandas</code>
</li>
</ol><ul><li>Use with <code>pandas.DataFrame()</code>,
<code>pandas.Series()</code>, etc.</li>
</ul><ol start="2" style="list-style-type: decimal"><li>Import with alias: <code>import pandas as pd</code>
</li>
</ol><ul><li>Use with <code>pd.DataFrame()</code>, <code>pd.Series()</code>,
etc.</li>
</ul><ol start="3" style="list-style-type: decimal"><li>Import specific functions or classes:
<code>from pandas import DataFrame</code>
</li>
</ol><ul><li>Use directly as <code>DataFrame()</code>.</li>
</ul><ol start="4" style="list-style-type: decimal"><li>Import multiple specific elements:
<code>from pandas import DataFrame, Series</code>
</li>
</ol><p>In general, we use the <strong>option 2</strong> for
<code>pandas</code>.</p>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="loading-data">Loading data<a class="anchor" aria-label="anchor" href="#loading-data"></a></h2>
<hr class="half-width"><div class="section level3">
<h3 id="loading-csv-data">Loading CSV data<a class="anchor" aria-label="anchor" href="#loading-csv-data"></a></h3>
<p>You can load a CSV file into a <code>pandas</code>
<code>DataFrame</code> using the <code>read_csv()</code> function:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'path</span><span class="ch">\t</span><span class="st">o</span><span class="ch">\f</span><span class="st">ile.csv'</span>)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="bu">print</span>(df.head())</span></code></pre>
</div>
<ul><li>
<code>read_csv()</code> reads the CSV file located at
<code>path\to\file.csv</code> and loads it into a <code>pandas</code>
<code>DataFrame</code> (<code>df</code>).</li>
<li>By default, it assumes that the file has a header row (i.e., column
names) in the first row.</li>
</ul><p>If the file does not have a header, you can use the
<code>header=None</code> parameter to let pandas generate default column
names.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'path</span><span class="ch">\t</span><span class="st">o</span><span class="ch">\f</span><span class="st">ile.csv'</span>, header<span class="op">=</span><span class="va">None</span>)</span></code></pre>
</div>
<p>You can pass arguments like <code>sep</code> if the file uses a
different delimiter (e.g., tab-separated <code>\t</code>).</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'path</span><span class="ch">\t</span><span class="st">o</span><span class="ch">\f</span><span class="st">ile.csv'</span>, sep<span class="op">=</span>`t`)</span></code></pre>
</div>
<div id="raw-string-literal" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="raw-string-literal" class="callout-inner">
<h3 class="callout-title">Raw string literal</h3>
<div class="callout-content">
<p>In Python, the <code>r</code> prefix before a string is used to
create a raw string literal. This tells Python to treat the string
exactly as it is, without interpreting backslashes (<code>\</code>) as
escape characters.</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="vs">r'path\to\file.csv'</span>)</span></code></pre>
</div>
<p>In regular strings, backslashes are used as escape characters. For
example, <code>\n</code> represents a new line.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="loading-excel-data">Loading Excel data<a class="anchor" aria-label="anchor" href="#loading-excel-data"></a></h3>
<p><code>pandas</code> provides the <code>read_excel()</code> function
for reading Excel files.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>df <span class="op">=</span> pd.read_excel(<span class="st">'path</span><span class="ch">\t</span><span class="st">o</span><span class="ch">\f</span><span class="st">ile.xlsx'</span>)</span></code></pre>
</div>
<p>You can specify the sheet name if the file contains multiple sheets.
By default, it will load the first sheet.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>df <span class="op">=</span> pd.read_excel(<span class="st">'data\sales_data.xlsx'</span>, sheet_name<span class="op">=</span><span class="st">'Q1_2024'</span>)</span></code></pre>
</div>
<p>You can also load multiple sheets into a dictionary of
<code>DataFrames</code> using <code>sheet_name=None</code>.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>df <span class="op">=</span> pd.read_excel(<span class="st">'data\sales_data.xlsx'</span>, sheet_name<span class="op">=</span><span class="va">None</span>)</span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="other-file-formats">Other file formats<a class="anchor" aria-label="anchor" href="#other-file-formats"></a></h3>
<p>You can also load data from other formats like JSON, or SQL
databases:</p>
<ul><li>JSON: <code>pd.read_json('your_file.json')</code>
</li>
<li>SQL:
<code>pd.read_sql('SELECT * FROM table', connection)</code>
</li>
</ul></div>
</section><section><h2 class="section-heading" id="data-exploration">Data exploration<a class="anchor" aria-label="anchor" href="#data-exploration"></a></h2>
<hr class="half-width"><div class="section level3">
<h3 id="viewing-the-first-few-rows">Viewing the first few rows<a class="anchor" aria-label="anchor" href="#viewing-the-first-few-rows"></a></h3>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="bu">print</span>(df.head())  <span class="co"># Shows the first 5 rows</span></span></code></pre>
</div>
<p>If you want to see more (or fewer) rows, you can pass a number to
<code>head()</code>, such as <code>df.head(10)</code> to view the first
10 rows.</p>
<p>Similarly, you can use the <code>tail()</code> method to view the
last few rows of the <code>DataFrame</code>.</p>
</div>
<div class="section level3">
<h3 id="viewing-the-columns">Viewing the columns<a class="anchor" aria-label="anchor" href="#viewing-the-columns"></a></h3>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="bu">print</span>(df.columns)  <span class="co"># Shows the first 5 rows</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="unique-values-in-columns">Unique values in columns<a class="anchor" aria-label="anchor" href="#unique-values-in-columns"></a></h3>
<p>To get a sense of the distinct values in a column, the
<code>unique()</code> and <code>value_counts()</code> methods are
useful.</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>df[<span class="st">'column_name'</span>].unique()</span></code></pre>
</div>
<p>The <code>unique()</code> method shows all the unique values in a
column.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>df[<span class="st">'column_name'</span>].value_counts()</span></code></pre>
</div>
<p>The <code>value_counts()</code> method returns the count of unique
values in the column, sorted in descending order. This is particularly
useful for categorical data.</p>
</div>
<div class="section level3">
<h3 id="checking-for-missing-values">Checking for missing values<a class="anchor" aria-label="anchor" href="#checking-for-missing-values"></a></h3>
<p>The <code>isnull()</code> method returns a <code>DataFrame</code> of
the same shape as <code>df</code>, where each element is a boolean
(<code>True</code> for missing values and <code>False</code> for
non-missing values).</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="bu">print</span>(df.isnull())</span></code></pre>
</div>
<p>To get the total number of missing values in each column, you can
chain <code>sum()</code> to <code>isnull()</code>.</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="bu">print</span>(df.isnull().<span class="bu">sum</span>())</span></code></pre>
</div>
<p>This gives you a count of how many missing values are present in each
column.</p>
</div>
<div class="section level3">
<h3 id="summary-statistics">Summary statistics<a class="anchor" aria-label="anchor" href="#summary-statistics"></a></h3>
<p>To get a quick overview of the numerical data, you can use:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="bu">print</span>(df.describe())</span></code></pre>
</div>
<p>The <code>describe()</code> method provides summary statistics for
all numeric columns, including:</p>
<ul><li>
<code>count</code>: the number of non-null entries</li>
<li>
<code>mean</code>: the average value</li>
<li>
<code>std</code>: the standard deviation</li>
<li>
<code>min</code>/<code>max</code>: the minimum and maximum
values</li>
<li>
<code>25%</code>, <code>50%</code>, <code>75%</code>: the
percentiles</li>
</ul></div>
<div class="section level3">
<h3 id="checking-the-data-types">Checking the data types<a class="anchor" aria-label="anchor" href="#checking-the-data-types"></a></h3>
<p>To understand the types of data in each column:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="bu">print</span>(df.dtypes)</span></code></pre>
</div>
<div id="exploring-a-sdmx-dataset" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exploring-a-sdmx-dataset" class="callout-inner">
<h3 class="callout-title">Exploring a SDMX dataset</h3>
<div class="callout-content">
<p>Using the <code>education.csv</code> dataset in the materials for
this episode, write the lines of code to:</p>
<ul><li>Import <code>pandas</code>
</li>
<li>Load the dataset into a <code>pandas</code>
<code>DataFrame</code>
</li>
<li>Print the list of columns in this dataset</li>
<li>Print the unique values of the <code>REF_AREA</code> column</li>
</ul></div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="vs">r"education.csv"</span>)</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a><span class="bu">print</span>(df.columns)</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a><span class="bu">print</span>(df[<span class="st">"REF_AREA"</span>].unique())</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Index(['STRUCTURE', 'STRUCTURE_ID', 'STRUCTURE_NAME', 'ACTION', 'REF_AREA',
       'Reference area', 'MEASURE', 'Measure', 'UNIT_MEASURE',
       'Unit of measure', 'INST_TYPE_EDU', 'Type of educational institution',
       'EDUCATION_LEV', 'Education level', 'AGE', 'Age', 'SUBJ_TYPE',
       'Subject', 'OBS_VALUE', 'Observation value', 'OBS_STATUS',
       'Observation status', 'UNIT_MULT', 'Unit multiplier',
       'STATISTICAL_OPERATION', 'Statistical operation', 'REF_PERIOD',
       'Reference period', 'DECIMALS', 'Decimals'],
      dtype='object')
['BFR' 'CHN' 'ESP' 'ISL' 'MEX' 'CHE' 'DEU' 'LTU' 'SAU' 'AUS' 'CAN' 'NLD'
 'CHL' 'FRA' 'KOR' 'GRC' 'LUX' 'ROU' 'FIN' 'IND' 'IRL' 'ISR' 'CZE' 'SVK'
 'TUR' 'USA' 'SVN' 'BGR' 'SWE' 'ZAF' 'UKM' 'NZL' 'OECD' 'BFL' 'IDN' 'NOR'
 'DNK' 'HRV' 'HUN' 'ARG' 'CRI' 'EST' 'COL' 'PER' 'POL' 'PRT' 'UKB' 'ITA'
 'BRA' 'JPN' 'LVA' 'EU25' 'G20' 'AUT']</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="cleaning-data">Cleaning data<a class="anchor" aria-label="anchor" href="#cleaning-data"></a></h2>
<hr class="half-width"><div class="section level3">
<h3 id="renaming-columns">Renaming columns<a class="anchor" aria-label="anchor" href="#renaming-columns"></a></h3>
<p>You may want to rename columns for clarity:</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>df.rename(columns<span class="op">=</span>{<span class="st">'old_name'</span>: <span class="st">'new_name'</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre>
</div>
<div id="callout3" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout</h3>
<div class="callout-content">
<p>The <code>inplace=True</code> parameter means that we are modifying
the original <code>DataFrame</code> <code>df</code> directly.</p>
<p>By default, <code>inplace=False</code>, which means the following
line won’t rename the <code>old_name</code> column:</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>df.rename(columns<span class="op">=</span>{<span class="st">'old_name'</span>: <span class="st">'new_name'</span>})</span></code></pre>
</div>
<p>An alternative is to create a new <code>DataFrame</code> with the
renamed columns and assign it back to <code>df</code>:</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>df <span class="op">=</span> df.rename(columns<span class="op">=</span>{<span class="st">'old_name'</span>: <span class="st">'new_name'</span>})</span></code></pre>
</div>
<p>The <code>inplace</code> parameter is present in many other
<code>pandas</code> methods.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="dropping-columns">Dropping columns<a class="anchor" aria-label="anchor" href="#dropping-columns"></a></h3>
<p>If you no longer need a column, you can drop it:</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>df.drop(columns<span class="op">=</span>[<span class="st">'column_name'</span>], inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre>
</div>
<p>You can also select specific columns from a <code>DataFrame</code> by
passing a list of column names to the <code>DataFrame</code> inside
double brackets.</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>df <span class="op">=</span> df[[<span class="st">"col1"</span>, <span class="st">"col2"</span>]]</span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="removing-duplicates">Removing duplicates<a class="anchor" aria-label="anchor" href="#removing-duplicates"></a></h3>
<p>To remove duplicate rows, use the <code>drop_duplicates()</code>
method, which removes all duplicate rows by default.</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>df_cleaned <span class="op">=</span> df.drop_duplicates()</span></code></pre>
</div>
<p>You can also specify which columns to check for duplicates by passing
a subset to the subset parameter:</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>df_cleaned <span class="op">=</span> df.drop_duplicates(subset<span class="op">=</span>[<span class="st">'A'</span>])</span></code></pre>
</div>
<p>This will remove duplicates based only on column <code>A</code>.</p>
</div>
<div class="section level3">
<h3 id="handling-missing-data">Handling missing data<a class="anchor" aria-label="anchor" href="#handling-missing-data"></a></h3>
<p>You can handle missing data it in various ways:</p>
<ul><li>Dropping rows with missing values:</li>
</ul><div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>df.dropna(inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre>
</div>
<ul><li>Filling missing values with a default value:</li>
</ul><div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>df.fillna(<span class="dv">0</span>, inplace<span class="op">=</span><span class="va">True</span>)  <span class="co"># Fill missing values with 0</span></span></code></pre>
</div>
<div id="callout4" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout</h3>
<div class="callout-content">
<p>Some methods, such as <code>fillna()</code> can be applied both on
<code>Series</code> and <code>DataFrame</code> objects.</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>df[<span class="st">'A'</span>] <span class="op">=</span> df[<span class="st">'A'</span>].fillna(<span class="dv">0</span>) <span class="co"># Fill missing values in column 'A' with 0</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="first-cleaning-steps" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="first-cleaning-steps" class="callout-inner">
<h3 class="callout-title">First cleaning steps</h3>
<div class="callout-content">
<p>Using the <code>education.csv</code> dataset in the materials for
this episode (continuing on the script of the previous exercise), write
the lines of code to:</p>
<ul><li>Keep only the following columns: <code>REF_AREA</code>,
<code>AGE</code>, <code>SUBJ_TYPE</code>, <code>OBS_VALUE</code>,
<code>REF_PERIOD</code>
</li>
<li>Rename them with simpler names: <code>iso3</code>, <code>age</code>,
<code>subject</code>, <code>value</code>, <code>year</code>
</li>
<li>Drop rows with missing data</li>
</ul></div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="co"># Keeping only the necessary columns</span></span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>df <span class="op">=</span> df[[<span class="st">"REF_AREA"</span>, <span class="st">"AGE"</span>, <span class="st">"SUBJ_TYPE"</span>, <span class="st">"OBS_VALUE"</span>, <span class="st">"REF_PERIOD"</span>]]</span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a><span class="co"># Rename them</span></span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>df.rename(columns<span class="op">=</span>{</span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a>    <span class="st">"REF_AREA"</span>: <span class="st">"iso3"</span>,</span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a>    <span class="st">"AGE"</span>: <span class="st">"age"</span>,</span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a>     <span class="st">"SUBJ_TYPE"</span>: <span class="st">"subject"</span>,</span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a>     <span class="st">"OBS_VALUE"</span>: <span class="st">"value"</span>,</span>
<span id="cb32-10"><a href="#cb32-10" tabindex="-1"></a>     <span class="st">"REF_PERIOD"</span>: <span class="st">"year"</span>},</span>
<span id="cb32-11"><a href="#cb32-11" tabindex="-1"></a>     inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb32-12"><a href="#cb32-12" tabindex="-1"></a></span>
<span id="cb32-13"><a href="#cb32-13" tabindex="-1"></a><span class="co"># Drop rows with missing data</span></span>
<span id="cb32-14"><a href="#cb32-14" tabindex="-1"></a>df.dropna(inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="transforming-data">Transforming data<a class="anchor" aria-label="anchor" href="#transforming-data"></a></h2>
<hr class="half-width"><div class="section level3">
<h3 id="filtering-rows">Filtering rows<a class="anchor" aria-label="anchor" href="#filtering-rows"></a></h3>
<p>You can filter rows based on certain conditions. For example, to
filter for rows where the column <code>age</code> is greater than
30:</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>df_filtered <span class="op">=</span> df[df[<span class="st">'age'</span>] <span class="op">&gt;</span> <span class="dv">30</span>]</span></code></pre>
</div>
<p>Another way to do this is to use <code>loc</code> (Label Based
Indexing):</p>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a>df_filtered <span class="op">=</span> df.loc[df[<span class="st">'age'</span>] <span class="op">&gt;</span> <span class="dv">30</span>]</span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="replacing-values-based-on-condition">Replacing values based on condition<a class="anchor" aria-label="anchor" href="#replacing-values-based-on-condition"></a></h3>
<p><code>loc</code> can also be used to replace values in a
<code>DataFrame</code> based on conditions. Let’s assume we have the
following <code>DataFrame</code>, and we want to update certain values
based on specific conditions.</p>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a>data <span class="op">=</span> {</span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a>    <span class="st">'Name'</span>: [<span class="st">'Alice'</span>, <span class="st">'Bob'</span>, <span class="st">'Charlie'</span>, <span class="st">'David'</span>],</span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>    <span class="st">'Age'</span>: [<span class="dv">25</span>, <span class="dv">30</span>, <span class="dv">35</span>, <span class="dv">40</span>],</span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a>    <span class="st">'City'</span>: [<span class="st">'New York'</span>, <span class="st">'Los Angeles'</span>, <span class="st">'Chicago'</span>, <span class="st">'San Francisco'</span>]</span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a>}</span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb35-8"><a href="#cb35-8" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Original DataFrame:"</span>)</span>
<span id="cb35-9"><a href="#cb35-9" tabindex="-1"></a><span class="bu">print</span>(df)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Original DataFrame:
      Name  Age             City
0    Alice   25         New York
1      Bob   30    Los Angeles
2  Charlie   35          Chicago
3    David   40  San Francisco</code></pre>
</div>
<p>Suppose we want to replace the city for anyone over the age of 30
with Seattle.</p>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="co"># Replace 'City' with 'Seattle' where 'Age' is greater than 30</span></span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a>df.loc[df[<span class="st">'Age'</span>] <span class="op">&gt;</span> <span class="dv">30</span>, <span class="st">'City'</span>] <span class="op">=</span> <span class="st">'Seattle'</span></span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Updated DataFrame:"</span>)</span>
<span id="cb37-5"><a href="#cb37-5" tabindex="-1"></a><span class="bu">print</span>(df)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Updated DataFrame:
      Name  Age      City
0    Alice   25  New York
1      Bob   30  Los Angeles
2  Charlie   35   Seattle
3    David   40   Seattle</code></pre>
</div>
<ul><li>
<code>df['Age'] &gt; 30</code>: This is the condition used to filter
rows where the <code>Age</code> is greater than 30.</li>
<li>
<code>df.loc[df['Age'] &gt; 30, 'City']</code>: This selects the
<code>City</code> column for those rows where the condition is
true.</li>
<li>
<code>= 'Seattle'</code>: This replaces the value in the
<code>City</code> column with ‘Seattle’ for those rows.</li>
</ul></div>
<div class="section level3">
<h3 id="sorting-data">Sorting data<a class="anchor" aria-label="anchor" href="#sorting-data"></a></h3>
<p>To sort your <code>DataFrame</code> by a specific column:</p>
<div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a>df_sorted <span class="op">=</span> df.sort_values(by<span class="op">=</span><span class="st">'column_name'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="creating-new-columns">Creating new columns<a class="anchor" aria-label="anchor" href="#creating-new-columns"></a></h3>
<p>You can create new columns based on existing ones. For example:</p>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a>df[<span class="st">'new_column'</span>] <span class="op">=</span> df[<span class="st">'column1'</span>] <span class="op">+</span> df[<span class="st">'column2'</span>]</span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="replace-values-using-map">Replace values using <code>map</code>
<a class="anchor" aria-label="anchor" href="#replace-values-using-map"></a></h3>
<p>The <code>map()</code> method in <code>pandas</code> allows you to
apply a mapping or a function to each element in the
<code>Series</code>. You can use <code>map()</code> with a dictionary to
replace values in a <code>Series</code> according to the mapping
provided.</p>
<div class="codewrapper sourceCode" id="cb41">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a>data <span class="op">=</span> {</span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a>    <span class="st">'Name'</span>: [<span class="st">'Alice'</span>, <span class="st">'Bob'</span>, <span class="st">'Charlie'</span>, <span class="st">'David'</span>],</span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a>    <span class="st">'City'</span>: [<span class="st">'NY'</span>, <span class="st">'LA'</span>, <span class="st">'CHI'</span>, <span class="st">'SF'</span>]</span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a>    }</span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a></span>
<span id="cb41-6"><a href="#cb41-6" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb41-7"><a href="#cb41-7" tabindex="-1"></a></span>
<span id="cb41-8"><a href="#cb41-8" tabindex="-1"></a><span class="co"># Create a dictionary for mapping</span></span>
<span id="cb41-9"><a href="#cb41-9" tabindex="-1"></a></span>
<span id="cb41-10"><a href="#cb41-10" tabindex="-1"></a>city_map <span class="op">=</span> {</span>
<span id="cb41-11"><a href="#cb41-11" tabindex="-1"></a>    <span class="st">'NY'</span>: <span class="st">'New York'</span>,</span>
<span id="cb41-12"><a href="#cb41-12" tabindex="-1"></a>    <span class="st">'LA'</span>: <span class="st">'Los Angeles'</span>,</span>
<span id="cb41-13"><a href="#cb41-13" tabindex="-1"></a>    <span class="st">'CHI'</span>: <span class="st">'Chicago'</span>,</span>
<span id="cb41-14"><a href="#cb41-14" tabindex="-1"></a>    <span class="st">'SF'</span>: <span class="st">'San Francisco'</span></span>
<span id="cb41-15"><a href="#cb41-15" tabindex="-1"></a>    }</span>
<span id="cb41-16"><a href="#cb41-16" tabindex="-1"></a></span>
<span id="cb41-17"><a href="#cb41-17" tabindex="-1"></a><span class="co"># Apply the map function to replace city abbreviations</span></span>
<span id="cb41-18"><a href="#cb41-18" tabindex="-1"></a></span>
<span id="cb41-19"><a href="#cb41-19" tabindex="-1"></a>df[<span class="st">'City'</span>] <span class="op">=</span> df[<span class="st">'City'</span>].<span class="bu">map</span>(city_map)</span>
<span id="cb41-20"><a href="#cb41-20" tabindex="-1"></a></span>
<span id="cb41-21"><a href="#cb41-21" tabindex="-1"></a><span class="bu">print</span>(df)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Name City
0 Alice New York
1 Bob Los Angeles
2 Charlie Chicago
3 David San Francisco</code></pre>
</div>
<ul><li>
<code>city_map</code> is a dictionary where the keys are the city
abbreviations and the values are the full city names.</li>
<li>
<code>df['City'].map(city_map)</code>: This replaces the city
abbreviations with the corresponding full city names from the
<code>city_map</code> dictionary.</li>
</ul><div id="selection-and-mapping" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="selection-and-mapping" class="callout-inner">
<h3 class="callout-title">Selection and mapping</h3>
<div class="callout-content">
<p>We are still using the <code>education.csv</code> dataset in the
materials for this episode (continuing on the script of the previous
exercise).</p>
<ul><li>Now, we would like to focus on a subset of education subjects,
instead of using the full list (17 subjects). Write the lines of code to
select only the 8 subjects listed below.</li>
</ul><blockquote>
<p>You can use the <code>isin()</code> method in pandas is used to
filter rows .</p>
</blockquote>
<ul><li>You may have noticed that the column for subjects labels in the raw
data was filled with missing values. For a better readability, we will
transform subject codes into labels, using the following mapping:
<ul><li>
<code>READ</code>: “Reading, writing and literature”</li>
<li>
<code>MATH</code>: “Mathematics”</li>
<li>
<code>NSCI</code>: “Natural sciences”</li>
<li>
<code>SSCI</code>: “Social sciences”</li>
<li>
<code>SLAN</code>: “Second language”</li>
<li>
<code>OLAN</code>: “Other languages”</li>
<li>
<code>PHED</code>: “Physical education and health”</li>
<li>
<code>ARTS</code>: “Arts”</li>
</ul></li>
</ul></div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb43">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="co"># Selecting only the 8 main subjects and assign to a new dataframe</span></span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a>df_subset <span class="op">=</span> df.loc[df[<span class="st">'subject'</span>].isin([<span class="st">"READ"</span>, <span class="st">"MATH"</span>, <span class="st">"NSCI"</span>, <span class="st">"SSCI"</span>, <span class="st">"SLAN"</span>, <span class="st">"OLAN"</span>, <span class="st">"PHED"</span>, <span class="st">"ARTS"</span>])]</span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" tabindex="-1"></a><span class="co"># Adding labels</span></span>
<span id="cb43-5"><a href="#cb43-5" tabindex="-1"></a>df_subset[<span class="st">"subject_label"</span>] <span class="op">=</span> df_subset[<span class="st">"subject"</span>].<span class="bu">map</span>({</span>
<span id="cb43-6"><a href="#cb43-6" tabindex="-1"></a>    <span class="st">"READ"</span>: <span class="st">"Reading, writing and literature"</span>,</span>
<span id="cb43-7"><a href="#cb43-7" tabindex="-1"></a>    <span class="st">"MATH"</span>: <span class="st">"Mathematics"</span>,</span>
<span id="cb43-8"><a href="#cb43-8" tabindex="-1"></a>    <span class="st">"NSCI"</span>: <span class="st">"Natural sciences"</span>,</span>
<span id="cb43-9"><a href="#cb43-9" tabindex="-1"></a>    <span class="st">"SSCI"</span>: <span class="st">"Social sciences"</span>,</span>
<span id="cb43-10"><a href="#cb43-10" tabindex="-1"></a>    <span class="st">"SLAN"</span>: <span class="st">"Second language"</span>,</span>
<span id="cb43-11"><a href="#cb43-11" tabindex="-1"></a>    <span class="st">"OLAN"</span>: <span class="st">"Other languages"</span>,</span>
<span id="cb43-12"><a href="#cb43-12" tabindex="-1"></a>    <span class="st">"PHED"</span>: <span class="st">"Physical education and health"</span>,</span>
<span id="cb43-13"><a href="#cb43-13" tabindex="-1"></a>    <span class="st">"ARTS"</span>: <span class="st">"Arts"</span>})</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="pivoting-data">Pivoting data<a class="anchor" aria-label="anchor" href="#pivoting-data"></a></h3>
<p>Pivoting and melting are two important operations for reshaping data
in <code>pandas</code>. They are used to transform a
<code>DataFrame</code> from “long” format to “wide” format, and vice
versa.</p>
<div class="section level4">
<h4 id="pivot">Pivot<a class="anchor" aria-label="anchor" href="#pivot"></a></h4>
<p>The <code>pivot()</code> method reshapes the data by turning unique
values from one column into new columns. It’s useful when you want to
convert a “long” format <code>DataFrame</code> (where each row
represents a single observation) into a “wide” format (where each unique
value becomes a column).</p>
<div class="codewrapper sourceCode" id="cb44">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a>data <span class="op">=</span> {</span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a>    <span class="st">'Date'</span>: [<span class="st">'2021-01-01'</span>, <span class="st">'2021-01-01'</span>, <span class="st">'2021-01-02'</span>, <span class="st">'2021-01-02'</span>],</span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a>    <span class="st">'City'</span>: [<span class="st">'New York'</span>, <span class="st">'Los Angeles'</span>, <span class="st">'New York'</span>, <span class="st">'Los Angeles'</span>],</span>
<span id="cb44-4"><a href="#cb44-4" tabindex="-1"></a>    <span class="st">'Temperature'</span>: [<span class="dv">30</span>, <span class="dv">75</span>, <span class="dv">32</span>, <span class="dv">77</span>],</span>
<span id="cb44-5"><a href="#cb44-5" tabindex="-1"></a>}</span>
<span id="cb44-6"><a href="#cb44-6" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb44-8"><a href="#cb44-8" tabindex="-1"></a></span>
<span id="cb44-9"><a href="#cb44-9" tabindex="-1"></a><span class="co"># Pivoting the data</span></span>
<span id="cb44-10"><a href="#cb44-10" tabindex="-1"></a>pivot_df <span class="op">=</span> df.pivot(index<span class="op">=</span><span class="st">'Date'</span>, columns<span class="op">=</span><span class="st">'City'</span>, values<span class="op">=</span><span class="st">'Temperature'</span>)</span>
<span id="cb44-11"><a href="#cb44-11" tabindex="-1"></a><span class="bu">print</span>(pivot_df)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>City            Los Angeles  New York
Date
2021-01-01            75        30
2021-01-02            77        32</code></pre>
</div>
<ul><li>The <code>Date</code> column is used as the index.</li>
<li>The <code>City</code> column values are turned into new
columns.</li>
<li>The <code>Temperature</code> column is used to populate the new
DataFrame.</li>
</ul></div>
<div class="section level4">
<h4 id="melt">Melt<a class="anchor" aria-label="anchor" href="#melt"></a></h4>
<p>The <code>melt()</code> function is the opposite of
<code>pivot()</code>. It transforms a DataFrame from wide format to long
format.</p>
<div class="codewrapper sourceCode" id="cb46">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a>data <span class="op">=</span> {</span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a>    <span class="st">'Date'</span>: [<span class="st">'2021-01-01'</span>, <span class="st">'2021-01-02'</span>],</span>
<span id="cb46-3"><a href="#cb46-3" tabindex="-1"></a>    <span class="st">'New York'</span>: [<span class="dv">30</span>, <span class="dv">32</span>],</span>
<span id="cb46-4"><a href="#cb46-4" tabindex="-1"></a>    <span class="st">'Los Angeles'</span>: [<span class="dv">75</span>, <span class="dv">77</span>],</span>
<span id="cb46-5"><a href="#cb46-5" tabindex="-1"></a>}</span>
<span id="cb46-6"><a href="#cb46-6" tabindex="-1"></a></span>
<span id="cb46-7"><a href="#cb46-7" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb46-8"><a href="#cb46-8" tabindex="-1"></a></span>
<span id="cb46-9"><a href="#cb46-9" tabindex="-1"></a><span class="co"># Melting the data</span></span>
<span id="cb46-10"><a href="#cb46-10" tabindex="-1"></a>melted_df <span class="op">=</span> df.melt(id_vars<span class="op">=</span>[<span class="st">'Date'</span>], var_name<span class="op">=</span><span class="st">'City'</span>, value_name<span class="op">=</span><span class="st">'Temperature'</span>)</span>
<span id="cb46-11"><a href="#cb46-11" tabindex="-1"></a><span class="bu">print</span>(melted_df)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>         Date           City  Temperature
0  2021-01-01       New York           30
1  2021-01-02       New York           32
2  2021-01-01  Los Angeles           75
3  2021-01-02  Los Angeles           77</code></pre>
</div>
<ul><li>The <code>Date</code> column remains fixed (as
<code>id_vars</code>).</li>
<li>The <code>New York</code> and <code>Los Angeles</code> columns are
melted into a single <code>City</code> column, with corresponding values
in the <code>Temperature</code> column.</li>
</ul><div id="pivot-method" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="pivot-method" class="callout-inner">
<h3 class="callout-title">Pivot method</h3>
<div class="callout-content">
<p>You are given a dataset containing sales information for different
products over a few months.</p>
<div class="codewrapper sourceCode" id="cb48">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb48-2"><a href="#cb48-2" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" tabindex="-1"></a><span class="co"># Create the DataFrame</span></span>
<span id="cb48-4"><a href="#cb48-4" tabindex="-1"></a>data <span class="op">=</span> {</span>
<span id="cb48-5"><a href="#cb48-5" tabindex="-1"></a>    <span class="st">'Product'</span>: [<span class="st">'A'</span>, <span class="st">'A'</span>, <span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'B'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>, <span class="st">'C'</span>, <span class="st">'C'</span>],</span>
<span id="cb48-6"><a href="#cb48-6" tabindex="-1"></a>    <span class="st">'Month'</span>: [<span class="st">'January'</span>, <span class="st">'February'</span>, <span class="st">'March'</span>, <span class="st">'January'</span>, <span class="st">'February'</span>, <span class="st">'March'</span>, <span class="st">'January'</span>, <span class="st">'February'</span>, <span class="st">'March'</span>],</span>
<span id="cb48-7"><a href="#cb48-7" tabindex="-1"></a>    <span class="st">'Sales'</span>: [<span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">200</span>, <span class="dv">80</span>, <span class="dv">120</span>, <span class="dv">160</span>, <span class="dv">130</span>, <span class="dv">170</span>, <span class="dv">220</span>]</span>
<span id="cb48-8"><a href="#cb48-8" tabindex="-1"></a>}</span>
<span id="cb48-9"><a href="#cb48-9" tabindex="-1"></a></span>
<span id="cb48-10"><a href="#cb48-10" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data)</span></code></pre>
</div>
<p>Use the <code>pivot()</code> method to rearrange this DataFrame so
that the months become columns, and each product’s sales data for each
month appears under its respective column.</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4"> Show me the solution </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb49">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a>pivot_df <span class="op">=</span> df.pivot(index<span class="op">=</span><span class="st">'Product'</span>, columns<span class="op">=</span><span class="st">'Month'</span>, values<span class="op">=</span><span class="st">'Sales'</span>)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="merging-and-joining-data">Merging and joining data<a class="anchor" aria-label="anchor" href="#merging-and-joining-data"></a></h2>
<hr class="half-width"><div class="section level3">
<h3 id="merging-dataframes">Merging <code>DataFrames</code>
<a class="anchor" aria-label="anchor" href="#merging-dataframes"></a></h3>
<p>The <code>merge()</code> function in <code>pandas</code> is used to
combine two <code>DataFrames</code> based on one or more common columns.
It’s similar to SQL joins.</p>
<p>The basic syntax for merging two <code>DataFrames</code> is:</p>
<div class="codewrapper sourceCode" id="cb50">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a>pd.merge(left, right, how<span class="op">=</span><span class="st">'inner'</span>, on<span class="op">=</span><span class="va">None</span>, left_on<span class="op">=</span><span class="va">None</span>, right_on<span class="op">=</span><span class="va">None</span>)</span></code></pre>
</div>
<ul><li>
<code>left</code>: The first <code>DataFrame</code>.</li>
<li>
<code>right</code>: The second <code>DataFrame</code>.</li>
<li>
<code>how</code>: The type of merge to perform. Options include:
<ul><li>
<code>left</code>: Use only keys from the left
<code>DataFrame</code> (like a left join in SQL).</li>
<li>
<code>right</code>: Use only keys from the right
<code>DataFrame</code> (like a right join in SQL).</li>
<li>
<code>outer</code>: Use keys from both <code>DataFrames</code>,
filling in missing values with <code>NaN</code> (like a full outer join
in SQL).</li>
<li>
<code>inner</code>: Use only the common keys (like an inner join in
SQL, default option).</li>
</ul></li>
<li>
<code>on</code>: The column or index level names to join on. If not
specified, it will join on columns with the same name in both
<code>DataFrames</code>.</li>
<li>
<code>left_on</code> and <code>right_on</code>: Specify columns from
left and right <code>DataFrames</code> to merge on if the column names
are different.</li>
</ul><p>In the following example, we merge <code>DataFrames</code> on
multiple columns by passing a list to the <code>on</code> parameter.</p>
<div class="codewrapper sourceCode" id="cb51">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a>df1 <span class="op">=</span> pd.DataFrame({</span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a>    <span class="st">'Name'</span>: [<span class="st">'John'</span>, <span class="st">'Anna'</span>, <span class="st">'Peter'</span>],</span>
<span id="cb51-3"><a href="#cb51-3" tabindex="-1"></a>    <span class="st">'City'</span>: [<span class="st">'NY'</span>, <span class="st">'LA'</span>, <span class="st">'SF'</span>],</span>
<span id="cb51-4"><a href="#cb51-4" tabindex="-1"></a>    <span class="st">'Age'</span>: [<span class="dv">22</span>, <span class="dv">25</span>, <span class="dv">28</span>]</span>
<span id="cb51-5"><a href="#cb51-5" tabindex="-1"></a>})</span>
<span id="cb51-6"><a href="#cb51-6" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" tabindex="-1"></a>df2 <span class="op">=</span> pd.DataFrame({</span>
<span id="cb51-8"><a href="#cb51-8" tabindex="-1"></a>    <span class="st">'Name'</span>: [<span class="st">'John'</span>, <span class="st">'Anna'</span>, <span class="st">'Peter'</span>],</span>
<span id="cb51-9"><a href="#cb51-9" tabindex="-1"></a>    <span class="st">'City'</span>: [<span class="st">'NY'</span>, <span class="st">'LA'</span>, <span class="st">'DC'</span>],</span>
<span id="cb51-10"><a href="#cb51-10" tabindex="-1"></a>    <span class="st">'Salary'</span>: [<span class="dv">50000</span>, <span class="dv">60000</span>, <span class="dv">70000</span>]</span>
<span id="cb51-11"><a href="#cb51-11" tabindex="-1"></a>})</span>
<span id="cb51-12"><a href="#cb51-12" tabindex="-1"></a></span>
<span id="cb51-13"><a href="#cb51-13" tabindex="-1"></a><span class="co"># Merge on multiple columns</span></span>
<span id="cb51-14"><a href="#cb51-14" tabindex="-1"></a>merged_df <span class="op">=</span> pd.merge(df1, df2, how<span class="op">=</span><span class="st">'inner'</span>, on<span class="op">=</span>[<span class="st">'Name'</span>, <span class="st">'City'</span>])</span>
<span id="cb51-15"><a href="#cb51-15" tabindex="-1"></a><span class="bu">print</span>(merged_df)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>    Name City  Age  Salary
0   John   NY   22   50000
1   Anna   LA   25   60000</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="concatenating-dataframes">Concatenating <code>DataFrames</code>
<a class="anchor" aria-label="anchor" href="#concatenating-dataframes"></a></h3>
<p>In addition to merging <code>DataFrames</code>, <code>pandas</code>
provides the <code>concat()</code> function, which is useful for
combining <code>DataFrames</code> along a particular axis (either rows
or columns). While <code>merge()</code> is typically used for combining
<code>DataFrames</code> based on a shared key or index,
<code>concat()</code> is more straightforward and is generally used when
you want to append or stack <code>DataFrames</code> together.</p>
<p>The basic syntax for <code>concat()</code> is:</p>
<div class="codewrapper sourceCode" id="cb53">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a>pd.concat([df1, df2], axis<span class="op">=</span><span class="dv">0</span>, ignore_index<span class="op">=</span><span class="va">False</span>, join<span class="op">=</span><span class="st">'outer'</span>)</span></code></pre>
</div>
<ul><li><p><code>[df1, df2]</code>: A list of <code>DataFrames</code> to
concatenate.</p></li>
<li>
<p><code>axis</code>: The axis along which to concatenate:</p>
<ul><li>
<code>axis=0</code>: Concatenate along rows (default behavior). This
stacks <code>DataFrames</code> on top of each other.</li>
<li>
<code>axis=1</code>: Concatenate along columns, aligning
<code>DataFrames</code> side-by-side.</li>
</ul></li>
<li><p><code>ignore_index</code>: If <code>True</code>, the index will
be reset (i.e., it will generate a new index). If <code>False</code>,
the original indices of the <code>DataFrames</code> are
preserved.</p></li>
<li>
<p><code>join</code>: Determines how to handle indices (or columns
when <code>axis=1</code>):</p>
<ul><li>
<code>outer</code>: Takes the union of the indices (or columns) from
both <code>DataFrames</code> (default).</li>
<li>
<code>inner</code>: Takes the intersection of the indices (or
columns), excluding any non-overlapping indices (or columns).</li>
</ul></li>
</ul><p>When concatenating along rows (which is the default behavior), the
<code>DataFrames</code> are stacked on top of each other, and the rows
are added to the end of the previous <code>DataFrame</code>. This is
commonly used to combine datasets with the same structure but with
different data.</p>
<p>Here is an example for concatenating <code>DataFrames</code> with the
same columns:</p>
<div class="codewrapper sourceCode" id="cb54">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a>df1 <span class="op">=</span> pd.DataFrame({</span>
<span id="cb54-2"><a href="#cb54-2" tabindex="-1"></a>    <span class="st">'ID'</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>],</span>
<span id="cb54-3"><a href="#cb54-3" tabindex="-1"></a>    <span class="st">'Name'</span>: [<span class="st">'John'</span>, <span class="st">'Anna'</span>, <span class="st">'Peter'</span>]</span>
<span id="cb54-4"><a href="#cb54-4" tabindex="-1"></a>})</span>
<span id="cb54-5"><a href="#cb54-5" tabindex="-1"></a></span>
<span id="cb54-6"><a href="#cb54-6" tabindex="-1"></a>df2 <span class="op">=</span> pd.DataFrame({</span>
<span id="cb54-7"><a href="#cb54-7" tabindex="-1"></a>    <span class="st">'ID'</span>: [<span class="dv">4</span>, <span class="dv">5</span>],</span>
<span id="cb54-8"><a href="#cb54-8" tabindex="-1"></a>    <span class="st">'Name'</span>: [<span class="st">'Linda'</span>, <span class="st">'James'</span>]</span>
<span id="cb54-9"><a href="#cb54-9" tabindex="-1"></a>})</span>
<span id="cb54-10"><a href="#cb54-10" tabindex="-1"></a></span>
<span id="cb54-11"><a href="#cb54-11" tabindex="-1"></a><span class="co"># Concatenate along rows (stack vertically)</span></span>
<span id="cb54-12"><a href="#cb54-12" tabindex="-1"></a>concatenated_df <span class="op">=</span> pd.concat([df1, df2], axis<span class="op">=</span><span class="dv">0</span>, ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb54-13"><a href="#cb54-13" tabindex="-1"></a><span class="bu">print</span>(concatenated_df)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   ID   Name
0   1   John
1   2   Anna
2   3  Peter
3   4  Linda
4   5  James</code></pre>
</div>
<p>In this case:</p>
<ul><li>The two DataFrames <code>df1</code> and <code>df2</code> are stacked
vertically.</li>
<li>The <code>ignore_index=True</code> parameter ensures that the index
is reset to a default integer index (0 to 4).</li>
<li>If you didn’t set <code>ignore_index=True</code>, the original
indices from <code>df1</code> and <code>df2</code> would be
preserved.</li>
</ul><div id="merging-datasets" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="merging-datasets" class="callout-inner">
<h3 class="callout-title">Merging datasets</h3>
<div class="callout-content">
<p>We are given two datasets: one containing employee details and the
other containing their department information. We want to merge these
two datasets on the common column <code>Employee_ID</code> to create a
single <code>DataFrame</code> that contains employee details with their
department names, while making sure we won’t drop any observation.</p>
<div class="codewrapper sourceCode" id="cb56">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb56-2"><a href="#cb56-2" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" tabindex="-1"></a><span class="co"># Create the Employee DataFrame</span></span>
<span id="cb56-4"><a href="#cb56-4" tabindex="-1"></a>employee_data <span class="op">=</span> {</span>
<span id="cb56-5"><a href="#cb56-5" tabindex="-1"></a>    <span class="st">'Employee_ID'</span>: [<span class="dv">101</span>, <span class="dv">102</span>, <span class="dv">103</span>, <span class="dv">104</span>, <span class="dv">105</span>],</span>
<span id="cb56-6"><a href="#cb56-6" tabindex="-1"></a>    <span class="st">'Employee_Name'</span>: [<span class="st">'Alice'</span>, <span class="st">'Bob'</span>, <span class="st">'Charlie'</span>, <span class="st">'David'</span>, <span class="st">'Eva'</span>],</span>
<span id="cb56-7"><a href="#cb56-7" tabindex="-1"></a>    <span class="st">'Age'</span>: [<span class="dv">25</span>, <span class="dv">30</span>, <span class="dv">35</span>, <span class="dv">40</span>, <span class="dv">45</span>]</span>
<span id="cb56-8"><a href="#cb56-8" tabindex="-1"></a>}</span>
<span id="cb56-9"><a href="#cb56-9" tabindex="-1"></a></span>
<span id="cb56-10"><a href="#cb56-10" tabindex="-1"></a>employee_df <span class="op">=</span> pd.DataFrame(employee_data)</span>
<span id="cb56-11"><a href="#cb56-11" tabindex="-1"></a></span>
<span id="cb56-12"><a href="#cb56-12" tabindex="-1"></a><span class="co"># Create the Department DataFrame</span></span>
<span id="cb56-13"><a href="#cb56-13" tabindex="-1"></a>department_data <span class="op">=</span> {</span>
<span id="cb56-14"><a href="#cb56-14" tabindex="-1"></a>    <span class="st">'Employee_ID'</span>: [<span class="dv">101</span>, <span class="dv">102</span>, <span class="dv">103</span>, <span class="dv">106</span>],</span>
<span id="cb56-15"><a href="#cb56-15" tabindex="-1"></a>    <span class="st">'Department'</span>: [<span class="st">'HR'</span>, <span class="st">'Finance'</span>, <span class="st">'IT'</span>, <span class="st">'Marketing'</span>]</span>
<span id="cb56-16"><a href="#cb56-16" tabindex="-1"></a>}</span>
<span id="cb56-17"><a href="#cb56-17" tabindex="-1"></a></span>
<span id="cb56-18"><a href="#cb56-18" tabindex="-1"></a>department_df <span class="op">=</span> pd.DataFrame(department_data)</span>
<span id="cb56-19"><a href="#cb56-19" tabindex="-1"></a></span>
<span id="cb56-20"><a href="#cb56-20" tabindex="-1"></a><span class="co"># Display both DataFrames</span></span>
<span id="cb56-21"><a href="#cb56-21" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Employee DataFrame:"</span>)</span>
<span id="cb56-22"><a href="#cb56-22" tabindex="-1"></a><span class="bu">print</span>(employee_df)</span>
<span id="cb56-23"><a href="#cb56-23" tabindex="-1"></a></span>
<span id="cb56-24"><a href="#cb56-24" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Department DataFrame:"</span>)</span>
<span id="cb56-25"><a href="#cb56-25" tabindex="-1"></a><span class="bu">print</span>(department_df)</span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5"> Show me the solution </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" aria-labelledby="headingSolution5" data-bs-parent="#accordionSolution5">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb57">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a>merged_df <span class="op">=</span> pd.merge(employee_df, department_df, on<span class="op">=</span><span class="st">'Employee_ID'</span>, how<span class="op">=</span><span class="st">'outer'</span>)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="aggregating-data">Aggregating data<a class="anchor" aria-label="anchor" href="#aggregating-data"></a></h2>
<hr class="half-width"><p>Aggregation is often used to summarize data by applying functions
like sum, mean, etc., to groups of rows.</p>
<div class="section level3">
<h3 id="grouping-data">Grouping data<a class="anchor" aria-label="anchor" href="#grouping-data"></a></h3>
<p>The <code>groupby()</code> method in pandas is used to group data by
one or more columns. Once the data is grouped, you can apply an
aggregation function to each group.</p>
<div class="codewrapper sourceCode" id="cb58">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a>df_grouped <span class="op">=</span> df.groupby(<span class="st">'column_name'</span>).agg({<span class="st">'numeric_column'</span>: <span class="st">'mean'</span>})</span></code></pre>
</div>
<div class="section level4">
<h4 id="basic-grouping">Basic Grouping<a class="anchor" aria-label="anchor" href="#basic-grouping"></a></h4>
<p>Let’s assume we have a dataset of sales data that includes the
following columns: <code>store</code>, <code>product</code>, and
<code>sales</code>.</p>
<div class="codewrapper sourceCode" id="cb59">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb59-2"><a href="#cb59-2" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" tabindex="-1"></a>data <span class="op">=</span> {</span>
<span id="cb59-4"><a href="#cb59-4" tabindex="-1"></a>    <span class="st">'store'</span>: [<span class="st">'A'</span>, <span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>, <span class="st">'C'</span>, <span class="st">'A'</span>, <span class="st">'B'</span>],</span>
<span id="cb59-5"><a href="#cb59-5" tabindex="-1"></a>    <span class="st">'product'</span>: [<span class="st">'apple'</span>, <span class="st">'banana'</span>, <span class="st">'apple'</span>, <span class="st">'banana'</span>, <span class="st">'apple'</span>, <span class="st">'banana'</span>, <span class="st">'banana'</span>, <span class="st">'apple'</span>],</span>
<span id="cb59-6"><a href="#cb59-6" tabindex="-1"></a>    <span class="st">'sales'</span>: [<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>, <span class="dv">60</span>, <span class="dv">70</span>, <span class="dv">80</span>]</span>
<span id="cb59-7"><a href="#cb59-7" tabindex="-1"></a>}</span>
<span id="cb59-8"><a href="#cb59-8" tabindex="-1"></a></span>
<span id="cb59-9"><a href="#cb59-9" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb59-10"><a href="#cb59-10" tabindex="-1"></a></span>
<span id="cb59-11"><a href="#cb59-11" tabindex="-1"></a><span class="co"># Group by 'store' and calculate the total sales for each store</span></span>
<span id="cb59-12"><a href="#cb59-12" tabindex="-1"></a>grouped <span class="op">=</span> df.groupby(<span class="st">'store'</span>)[<span class="st">'sales'</span>].<span class="bu">sum</span>()</span>
<span id="cb59-13"><a href="#cb59-13" tabindex="-1"></a><span class="bu">print</span>(grouped)</span></code></pre>
</div>
<p>Output:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>store
A    100
B    150
C    110
Name: sales, dtype: int64</code></pre>
</div>
<p>In this example, we grouped the data by <code>store</code> and
calculated the total sales (<code>sum</code>) for each store.</p>
</div>
<div class="section level4">
<h4 id="grouping-by-multiple-columns">Grouping by Multiple Columns<a class="anchor" aria-label="anchor" href="#grouping-by-multiple-columns"></a></h4>
<p>You can also group by multiple columns. Let’s say we want to
calculate the total sales per store and per product:</p>
<div class="codewrapper sourceCode" id="cb61">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a>grouped_multiple <span class="op">=</span> df.groupby([<span class="st">'store'</span>, <span class="st">'product'</span>])[<span class="st">'sales'</span>].<span class="bu">sum</span>()</span>
<span id="cb61-2"><a href="#cb61-2" tabindex="-1"></a><span class="bu">print</span>(grouped_multiple)</span></code></pre>
</div>
<p>Output:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>store product
A apple 10
banana 90
B apple 30
banana 40
C apple 50
banana 60
Name: sales, dtype: int64</code></pre>
</div>
<p>This shows the total <code>sales</code> for each combination of
<code>store</code> and <code>product</code>.</p>
</div>
</div>
<div class="section level3">
<h3 id="aggregation-functions">Aggregation Functions<a class="anchor" aria-label="anchor" href="#aggregation-functions"></a></h3>
<p>Once you’ve grouped the data, you can apply different aggregation
functions. The most common ones include <code>sum()</code>,
<code>mean()</code>, <code>min()</code>, <code>max()</code>, and
<code>count()</code>. These can be used to summarize the data in various
ways.</p>
<div class="section level4">
<h4 id="calculating-the-mean">Calculating the mean<a class="anchor" aria-label="anchor" href="#calculating-the-mean"></a></h4>
<p>To calculate the average sales per store, you can use the
<code>mean()</code> function:</p>
<div class="codewrapper sourceCode" id="cb63">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a>mean_sales <span class="op">=</span> df.groupby(<span class="st">'store'</span>)[<span class="st">'sales'</span>].mean()</span>
<span id="cb63-2"><a href="#cb63-2" tabindex="-1"></a><span class="bu">print</span>(mean_sales)</span></code></pre>
</div>
<p>Output:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>store
A 33.333333
B 50.000000
C 55.000000
Name: sales, dtype: float64</code></pre>
</div>
</div>
<div class="section level4">
<h4 id="calculating-the-count">Calculating the count<a class="anchor" aria-label="anchor" href="#calculating-the-count"></a></h4>
<p>You can also count how many rows there are in each group. This is
useful when you want to know how many entries exist for each group:</p>
<div class="codewrapper sourceCode" id="cb65">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a>count_sales <span class="op">=</span> df.groupby(<span class="st">'store'</span>)[<span class="st">'sales'</span>].count()</span>
<span id="cb65-2"><a href="#cb65-2" tabindex="-1"></a><span class="bu">print</span>(count_sales)</span></code></pre>
</div>
<p>Output:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>store
A 3
B 3
C 3
Name: sales, dtype: int64</code></pre>
</div>
</div>
<div class="section level4">
<h4 id="using-custom-aggregations">Using custom aggregations<a class="anchor" aria-label="anchor" href="#using-custom-aggregations"></a></h4>
<p>You can also apply custom aggregation functions to your grouped data.
For example, let’s say you want to compute the range (difference between
the maximum and minimum) of sales for each store:</p>
<div class="codewrapper sourceCode" id="cb67">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" tabindex="-1"></a>range_sales <span class="op">=</span> df.groupby(<span class="st">'store'</span>)[<span class="st">'sales'</span>].agg(<span class="kw">lambda</span> x: x.<span class="bu">max</span>() <span class="op">-</span> x.<span class="bu">min</span>())</span>
<span id="cb67-2"><a href="#cb67-2" tabindex="-1"></a><span class="bu">print</span>(range_sales)</span></code></pre>
</div>
<p>Output:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>store
A 60
B 50
C 10
Name: sales, dtype: int64</code></pre>
</div>
<div id="aggregating-data-using-groupby" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="aggregating-data-using-groupby" class="callout-inner">
<h3 class="callout-title">Aggregating data using
<code>groupby()</code>
</h3>
<div class="callout-content">
<p>Let’s now go back to our script for transforming the education
dataset.</p>
<p>The <code>df_subset</code> <code>DataFrame</code> provides for each
country and age, the share of instruction time spent on each of the 8
selected subjets.</p>
<p>Now, we would like to compute the average share of instruction time
of each selected subject and country.</p>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6"> Show me the solution </h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" aria-labelledby="headingSolution6" data-bs-parent="#accordionSolution6">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb69">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" tabindex="-1"></a>df_average <span class="op">=</span> df_subset.groupby([<span class="st">"iso3"</span>, <span class="st">"subject"</span>, <span class="st">"subject_label"</span>, <span class="st">"year"</span>])[<span class="st">"value"</span>].mean().reset_index()</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="handling-missing-values-during-aggregation">Handling missing values during aggregation<a class="anchor" aria-label="anchor" href="#handling-missing-values-during-aggregation"></a></h3>
<p>When aggregating data, missing values (<code>NaN</code>) are
typically ignored by default. However, if you need to change this
behavior, you can control how <code>pandas</code> handles them using the
<code>skipna</code> argument.</p>
<p>For example, if you want to include missing values in your
aggregation, you can do the following:</p>
<div class="codewrapper sourceCode" id="cb70">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a>data <span class="op">=</span> {</span>
<span id="cb70-2"><a href="#cb70-2" tabindex="-1"></a>    <span class="st">'store'</span>: [<span class="st">'A'</span>, <span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>, <span class="st">'C'</span>, <span class="st">'A'</span>, <span class="st">'B'</span>],</span>
<span id="cb70-3"><a href="#cb70-3" tabindex="-1"></a>    <span class="st">'product'</span>: [<span class="st">'apple'</span>, <span class="st">'banana'</span>, <span class="st">'apple'</span>, <span class="st">'banana'</span>, <span class="st">'apple'</span>, <span class="st">'banana'</span>, <span class="st">'banana'</span>, <span class="st">'apple'</span>],</span>
<span id="cb70-4"><a href="#cb70-4" tabindex="-1"></a>    <span class="st">'sales'</span>: [<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>, <span class="va">None</span>, <span class="dv">70</span>, <span class="dv">80</span>]</span>
<span id="cb70-5"><a href="#cb70-5" tabindex="-1"></a>}</span>
<span id="cb70-6"><a href="#cb70-6" tabindex="-1"></a></span>
<span id="cb70-7"><a href="#cb70-7" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb70-8"><a href="#cb70-8" tabindex="-1"></a></span>
<span id="cb70-9"><a href="#cb70-9" tabindex="-1"></a><span class="co"># Group by store and calculate the sum, including missing values</span></span>
<span id="cb70-10"><a href="#cb70-10" tabindex="-1"></a>agg_sales_with_na <span class="op">=</span> df.groupby(<span class="st">'store'</span>)[<span class="st">'sales'</span>].<span class="bu">sum</span>(skipna<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb70-11"><a href="#cb70-11" tabindex="-1"></a><span class="bu">print</span>(agg_sales_with_na)</span></code></pre>
</div>
<p>Output:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>store
A     100.0
B     150.0
C      NaN
Name: sales, dtype: float64</code></pre>
</div>
<p>Notice that the sum for store C is <code>NaN</code> because the
<code>df</code> <code>DataFrame</code> contains a missing value.</p>
</div>
<div class="section level3">
<h3 id="aggregating-while-preserving-the-data-structure">Aggregating while preserving the data structure<a class="anchor" aria-label="anchor" href="#aggregating-while-preserving-the-data-structure"></a></h3>
<p>The <code>transform()</code> function in <code>pandas</code> allows
you to perform transformations on a group of data while preserving the
original structure. Unlike aggregation (which reduces data),
<code>transform()</code> returns a <code>DataFrame</code> or
<code>Series</code> with the same index as the original.</p>
<p>If you want to rank the sales data within each store, you can use the
<code>rank()</code> function inside <code>transform()</code>:</p>
<div class="codewrapper sourceCode" id="cb72">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a><span class="co"># Rank the sales within each store</span></span>
<span id="cb72-2"><a href="#cb72-2" tabindex="-1"></a>df[<span class="st">'sales_rank'</span>] <span class="op">=</span> df.groupby(<span class="st">'store'</span>)[<span class="st">'sales'</span>].transform(<span class="st">'rank'</span>)</span>
<span id="cb72-3"><a href="#cb72-3" tabindex="-1"></a><span class="bu">print</span>(df)</span></code></pre>
</div>
<p>Output:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  store  product  sales  sales_rank
0     A    apple     10         1.0
1     A   banana     20         2.0
2     B    apple     30         1.0
3     B   banana     40         2.0
4     C    apple     50         1.0
5     C   banana     60         2.0
6     A   banana     70         3.0
7     B    apple     80         3.0</code></pre>
</div>
</div>
</section><section><h2 class="section-heading" id="exporting-data">Exporting data<a class="anchor" aria-label="anchor" href="#exporting-data"></a></h2>
<hr class="half-width"><p>Once you’ve wrangled your data, you may want to export it to a
file.</p>
<div class="section level3">
<h3 id="exporting-to-csv">Exporting to CSV<a class="anchor" aria-label="anchor" href="#exporting-to-csv"></a></h3>
<div class="codewrapper sourceCode" id="cb74">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" tabindex="-1"></a>df.to_csv(<span class="st">'cleaned_data.csv'</span>, index<span class="op">=</span><span class="va">False</span>)</span></code></pre>
</div>
<blockquote>
<p><code>index=False</code> prevents the row index from being saved in
the file.</p>
</blockquote>
<p>You can also specify other options like separator
(<code>sep</code>):</p>
<div class="codewrapper sourceCode" id="cb75">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a>df.to_csv(<span class="st">'output_data.tsv'</span>, sep<span class="op">=</span><span class="st">'</span><span class="ch">\t</span><span class="st">'</span>, index<span class="op">=</span><span class="va">False</span>)</span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="exporting-to-excel">Exporting to Excel<a class="anchor" aria-label="anchor" href="#exporting-to-excel"></a></h3>
<div class="codewrapper sourceCode" id="cb76">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a>df.to_excel(<span class="st">'cleaned_data.xlsx'</span>, index<span class="op">=</span><span class="va">False</span>)</span></code></pre>
</div>
<p>You can also specify which sheet name to use with the
<code>sheet_name</code> parameter:</p>
<div class="codewrapper sourceCode" id="cb77">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a>df.to_excel(<span class="st">'output_data.xlsx'</span>, sheet_name<span class="op">=</span><span class="st">'Sheet1'</span>, index<span class="op">=</span><span class="va">False</span>)</span></code></pre>
</div>
<p>If you’re dealing with multiple <code>DataFrames</code> and need to
save them in different sheets of the same Excel file, you can use
<code>ExcelWriter</code>:</p>
<div class="codewrapper sourceCode" id="cb78">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" tabindex="-1"></a><span class="cf">with</span> pd.ExcelWriter(<span class="st">'output_data.xlsx'</span>) <span class="im">as</span> writer:</span>
<span id="cb78-2"><a href="#cb78-2" tabindex="-1"></a>    df.to_excel(writer, sheet_name<span class="op">=</span><span class="st">'Sheet1'</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb78-3"><a href="#cb78-3" tabindex="-1"></a>    df.to_excel(writer, sheet_name<span class="op">=</span><span class="st">'Sheet2'</span>, index<span class="op">=</span><span class="va">False</span>)</span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="other-supported-export-formats">Other supported export formats<a class="anchor" aria-label="anchor" href="#other-supported-export-formats"></a></h3>
<p>Other supported export formats include:</p>
<table class="table"><colgroup><col width="14%"><col width="32%"><col width="52%"></colgroup><thead><tr class="header"><th>Format</th>
<th>Method</th>
<th>Example Usage</th>
</tr></thead><tbody><tr class="odd"><td><strong>CSV</strong></td>
<td><code>DataFrame.to_csv()</code></td>
<td><code>df.to_csv('output_data.csv')</code></td>
</tr><tr class="even"><td><strong>Excel</strong></td>
<td><code>DataFrame.to_excel()</code></td>
<td><code>df.to_excel('output_data.xlsx')</code></td>
</tr><tr class="odd"><td><strong>JSON</strong></td>
<td><code>DataFrame.to_json()</code></td>
<td><code>df.to_json('output_data.json')</code></td>
</tr><tr class="even"><td><strong>SQL</strong></td>
<td><code>DataFrame.to_sql()</code></td>
<td><code>df.to_sql('my_table', conn)</code></td>
</tr><tr class="odd"><td><strong>HDF5</strong></td>
<td><code>DataFrame.to_hdf()</code></td>
<td><code>df.to_hdf('output_data.h5', key='df')</code></td>
</tr><tr class="even"><td><strong>Parquet</strong></td>
<td><code>DataFrame.to_parquet()</code></td>
<td><code>df.to_parquet('output_data.parquet')</code></td>
</tr><tr class="odd"><td><strong>Feather</strong></td>
<td><code>DataFrame.to_feather()</code></td>
<td><code>df.to_feather('output_data.feather')</code></td>
</tr><tr class="even"><td><strong>Pickle</strong></td>
<td><code>DataFrame.to_pickle()</code></td>
<td><code>df.to_pickle('output')</code></td>
</tr></tbody></table><p>Each of these export functions has additional parameters for
customizing how the data is saved (e.g., file paths, indexes, column
selections). You can refer to the pandas documentation for more advanced
options for each method.</p>
</div>
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/03-lists_dictionaries.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/05-data_visualisation.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/03-lists_dictionaries.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: List and Dictionary
        </a>
        <a class="chapter-link float-end" href="../instructor/05-data_visualisation.html" rel="next">
          Next: Visualizations...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/UNECE/ModernStats_Python/edit/main/episodes/04-data_transformation.md" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/UNECE/ModernStats_Python/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/UNECE/ModernStats_Python/" class="external-link">Source</a></p>
				<p><a href="https://github.com/UNECE/ModernStats_Python/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:team@carpentries.org">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.10" class="external-link">sandpaper (0.16.10)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.7" class="external-link">pegboard (0.7.7)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.5" class="external-link">varnish (1.0.5)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://UNECE.github.io/ModernStats_Python/instructor/04-data_transformation.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "Data Transformation",
  "creativeWorkStatus": "active",
  "url": "https://UNECE.github.io/ModernStats_Python/instructor/04-data_transformation.html",
  "identifier": "https://UNECE.github.io/ModernStats_Python/instructor/04-data_transformation.html",
  "dateCreated": "2023-03-06",
  "dateModified": "2024-12-11",
  "datePublished": "2024-12-16"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo --><script>
          var _paq = window._paq = window._paq || [];
          /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
          _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
          _paq.push(["setDomains", ["*.lessons.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
          _paq.push(["setDoNotTrack", true]);
          _paq.push(["disableCookies"]);
          _paq.push(["trackPageView"]);
          _paq.push(["enableLinkTracking"]);
          (function() {
              var u="https://matomo.carpentries.org/";
              _paq.push(["setTrackerUrl", u+"matomo.php"]);
              _paq.push(["setSiteId", "1"]);
              var d=document, g=d.createElement("script"), s=d.getElementsByTagName("script")[0];
              g.async=true; g.src="https://matomo.carpentries.org/matomo.js"; s.parentNode.insertBefore(g,s);
          })();
        </script><!-- End Matomo Code --></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

